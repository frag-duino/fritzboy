#include <gb/gb.h>
#include <stdio.h>
#include <gb/drawing.h>
#include <rand.h>

unsigned char tile_fritzbox[] =
{
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x01, 0x01, 0x02, 0x02, 0x04, 0x04, 0x08, 0x08,
  0x11, 0x10, 0x23, 0x20, 0x47, 0x40, 0x6E, 0x61,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0F, 0x0F,
  0x10, 0x10, 0x20, 0x20, 0x40, 0x41, 0x8C, 0x80,
  0x1E, 0x00, 0x3F, 0x00, 0x7F, 0x00, 0xFF, 0x00,
  0xFF, 0x00, 0xBF, 0x40, 0x7F, 0x80, 0xEF, 0x10,
  0x3D, 0x32, 0x1F, 0x18, 0x0F, 0x0C, 0x07, 0x06,
  0x03, 0x03, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0xDF, 0x20, 0xBB, 0x44, 0x77, 0x88, 0xEE, 0x11,
  0xDD, 0x22, 0xFB, 0x84, 0xF7, 0xC8, 0x7E, 0x60,
  0x3C, 0x30, 0x18, 0x18, 0x0C, 0x0C, 0x06, 0x06,
  0x03, 0x03, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x80, 0x80, 0x40, 0x40, 0x20, 0x20, 0x10, 0x90,
  0x08, 0x08, 0x04, 0x24, 0x82, 0x12, 0xC1, 0x01,
  0xE0, 0x00, 0xF0, 0x00, 0xF8, 0x00, 0xFC, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x20, 0x20, 0x50, 0x70, 0x50, 0x70, 0x50, 0x70,
  0x50, 0x70, 0x50, 0x70, 0x50, 0x70, 0x50, 0x70,
  0xD0, 0xF0, 0x50, 0x70, 0x30, 0x30, 0x10, 0x10,
  0xFC, 0x00, 0xF8, 0x00, 0xF0, 0x00, 0xE0, 0x00,
  0xC0, 0x00, 0x81, 0x01, 0x03, 0x02, 0x07, 0x04,
  0x0F, 0x09, 0x1F, 0x13, 0x3E, 0x26, 0x7C, 0x4C,
  0xF8, 0x98, 0xF0, 0xF0, 0x00, 0x00, 0x00, 0x00,
  0x08, 0x08, 0x1C, 0x1C, 0x3C, 0x24, 0x7C, 0x4C,
  0xF8, 0x98, 0xF0, 0x30, 0xE0, 0x60, 0xC0, 0xC0,
  0x80, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x7F, 0x00, 0x7F, 0x00,
  0x7F, 0x00, 0x70, 0x0F, 0x70, 0x08, 0x70, 0x08,
  0x7F, 0x00, 0x7F, 0x00, 0x7F, 0x00, 0x70, 0x0F,
  0x70, 0x08, 0x70, 0x08, 0x70, 0x08, 0x00, 0x38,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80,
  0x1C, 0x80, 0x7F, 0x80, 0x73, 0x08, 0x73, 0x08,
  0x73, 0x08, 0x7F, 0x80, 0x7E, 0x81, 0x7C, 0x82,
  0x7C, 0x00, 0x76, 0x08, 0x77, 0x08, 0x77, 0x08,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x73, 0x08, 0x00, 0x38, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x38, 0x00, 0x18, 0x00, 0x38, 0x04,
  0x3B, 0x04, 0x3B, 0x04, 0xBB, 0x04, 0xB8, 0x45,
  0xB8, 0x44, 0x38, 0x84, 0x38, 0x04, 0x38, 0x04,
  0x38, 0x04, 0x38, 0x04, 0x00, 0x9C, 0x80, 0x40,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0xFE, 0x01, 0xFE, 0x01, 0xFE, 0x01, 0x70, 0x8F,
  0x70, 0x08, 0x70, 0x08, 0x70, 0x08, 0x70, 0x08,
  0x70, 0x08, 0x70, 0x08, 0x70, 0x08, 0x70, 0x08,
  0x00, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x70, 0x08, 0x00, 0x38, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFF, 0x00,
  0xFF, 0x00, 0xFF, 0x00, 0x00, 0x00, 0x01, 0x00,
  0x03, 0x00, 0x07, 0x00, 0x0E, 0x01, 0x1C, 0x03,
  0x3F, 0x00, 0x7F, 0x00, 0xFF, 0x00, 0x00, 0x7F,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFC, 0x00,
  0xF8, 0x00, 0xF0, 0x0C, 0xE0, 0x18, 0xC0, 0x30,
  0x80, 0x60, 0x00, 0xC0, 0x00, 0x80, 0x00, 0x00,
  0xFC, 0x00, 0xFC, 0x02, 0xFC, 0x02, 0x00, 0xFE,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0xE3,
  0x42, 0xA2, 0x42, 0xA2, 0x42, 0xA2, 0x42, 0xA2,
  0x43, 0xA3, 0x42, 0xA2, 0x02, 0xE2, 0x02, 0x02,
  0x02, 0x42, 0x42, 0xA2, 0x03, 0x43, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xC1, 0xC1,
  0x22, 0x22, 0x24, 0x24, 0x24, 0x24, 0x44, 0x44,
  0xF4, 0xF4, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14,
  0x14, 0x14, 0x22, 0x22, 0xC1, 0xC1, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xC4, 0xC4,
  0x22, 0x22, 0x11, 0x11, 0x10, 0x10, 0x10, 0x10,
  0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10,
  0x10, 0x10, 0x20, 0x20, 0xC0, 0xC0, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04, 0x04,
  0x08, 0x08, 0x10, 0x10, 0xA0, 0xA0, 0x40, 0x40,
  0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x40,
  0x40, 0x40, 0x40, 0x40, 0x40, 0x40, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x88, 0x88,
  0x88, 0x88, 0xA8, 0xA8, 0xF8, 0xF8, 0xD8, 0xD8,
  0x00, 0x00, 0x18, 0x18, 0x20, 0x20, 0x20, 0x20,
  0x79, 0x79, 0x21, 0x21, 0x21, 0x21, 0x21, 0x21,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x47, 0x47, 0x89, 0x89, 0x09, 0x09, 0x07, 0x07,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x06, 0x06, 0x09, 0x09, 0x09, 0x09, 0x87, 0x87,
  0x01, 0x01, 0x0F, 0x0F, 0x19, 0x19, 0x13, 0x13,
  0x1E, 0x1E, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x3C, 0x3C, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x12, 0x12,
  0x72, 0x72, 0x92, 0x92, 0x92, 0x92, 0x71, 0x71,
  0x00, 0x00, 0x08, 0x08, 0x00, 0x00, 0x41, 0x41,
  0x49, 0x49, 0x49, 0x49, 0x49, 0x49, 0x89, 0x89,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xC3, 0xC3,
  0x24, 0x24, 0x24, 0x24, 0x24, 0x24, 0x23, 0x23,
  0x78, 0x78, 0x44, 0x44, 0x04, 0x04, 0x18, 0x18,
  0x20, 0x20, 0x60, 0x60, 0x42, 0x42, 0x7C, 0x7C,
  0x3C, 0x3C, 0x42, 0x42, 0x42, 0x42, 0x42, 0x42,
  0x42, 0x42, 0x42, 0x42, 0x42, 0x42, 0x3C, 0x3C,
  0x08, 0x08, 0x18, 0x18, 0x28, 0x28, 0x48, 0x48,
  0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08,
  0x7E, 0x7E, 0x40, 0x40, 0x40, 0x40, 0x3C, 0x3C,
  0x02, 0x02, 0x02, 0x02, 0x04, 0x04, 0x78, 0x78,
  0x66, 0x66, 0x7E, 0x7E, 0x5A, 0x5A, 0x5A, 0x5A,
  0x42, 0x42, 0x42, 0x42, 0x42, 0x42, 0x42, 0x42,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3C, 0x3C,
  0x44, 0x44, 0x44, 0x44, 0x44, 0x44, 0x3E, 0x3E,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x53, 0x53,
  0x64, 0x64, 0x44, 0x44, 0x44, 0x44, 0x43, 0x43,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x38, 0x38,
  0x44, 0x44, 0x7C, 0x7C, 0x40, 0x40, 0x3C, 0x3C,
  0x84, 0x84, 0x84, 0x84, 0x84, 0x84, 0x84, 0x84,
  0x84, 0x84, 0x84, 0x84, 0x84, 0x84, 0x84, 0x84,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x7C, 0x7C, 0x92, 0x92, 0x92, 0x92, 0x82, 0x82,
  0x00, 0x00, 0x00, 0x00, 0x40, 0x40, 0x00, 0x00,
  0x46, 0x46, 0x49, 0x49, 0x49, 0x49, 0x47, 0x47,
  0x01, 0x01, 0x0F, 0x0F, 0x19, 0x19, 0x13, 0x13,
  0x1E, 0x1E, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01,
  0x87, 0x87, 0x89, 0x89, 0x89, 0x89, 0x27, 0x27,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x30, 0x30,
  0x48, 0x48, 0x70, 0x70, 0x40, 0x40, 0x38, 0x38,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x88, 0x88,
  0x88, 0x88, 0xA8, 0xA8, 0xF8, 0xF8, 0xD9, 0xD9,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};

unsigned char map_fritzbox[] =
{
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0x12, 0x18, 0x1A, 0x20,
  0x22, 0x28, 0x2A, 0x30, 0x32, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x11, 0x13, 0x19, 0x1B, 0x21,
  0x23, 0x29, 0x2B, 0x31, 0x33, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x16, 0x1C, 0x1E, 0x25,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02,
  0x08, 0x0A, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x03,
  0x09, 0x0B, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04, 0x06,
  0x0C, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x05, 0x07,
  0x0D, 0x0F, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x3D, 0x3E, 0x3F, 0x40, 0x00, 0x41,
  0x42, 0x43, 0x44, 0x45, 0x46, 0x47, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x48, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x34, 0x34, 0x4B, 0x35, 0x36, 0x37,
  0x39, 0x3A, 0x3B, 0x3C, 0x49, 0x4A, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x4C, 0x00, 0x38,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};

int main ()
{
  UINT8 DEBUG = 0;
  UINT8 YPOSITION = 72;
  UINT8 GRAPHWIDTHFULL = 100;
  UINT8 GRAPHWIDTHHALF = 50;
  UBYTE max_downstream = 0;
  UBYTE max_upstream = 0;
  UBYTE current_downstream = 0;
  UBYTE current_upstream = 0;
  UINT8 XOFFSET = 30;
  UBYTE array_downstream[50]; // array for downstream values
  UBYTE array_upstream[50]; // array for upstream values
  UBYTE buffer[7]; // buffer for incoming transfer
  UBYTE i, n = 0;
  UBYTE random;
  UBYTE *s;
  UINT8 c; // For
  UINT8 position;
  UINT8 TMP = 2;
  UINT8 demomode = 0; 
  UINT8 packetreceived = 0;
  
  // Show welcome screen
  set_bkg_data(0, 127, tile_fritzbox);
  set_bkg_tiles(0, 0, 20, 18, map_fritzbox);
  SHOW_BKG;
  DISPLAY_ON;
  for (c = 0; c != 100; c++) {
    delay(40);
    if (joypad() != 0)
      break;
  }

  // Initialize arrays
  for (c = 0; c < GRAPHWIDTHHALF; c++) {
    array_downstream[c] = 0;
    array_upstream[c] = 0;
  }
  for (c = 0; c < 8; c++) {
    buffer[c] = 0;
  }

  // Initialize random
  initarand(0x5F);

  // Draw a box
  color(LTGREY, WHITE, SOLID);
  box(XOFFSET - 1, YPOSITION - 52, XOFFSET + GRAPHWIDTHFULL - 1, YPOSITION + 52, M_NOFILL);

  // Draw a line in the middle
  color(BLACK, WHITE, SOLID);
  line(XOFFSET, YPOSITION, XOFFSET + GRAPHWIDTHFULL - 1, YPOSITION);

  // Write text
  gotogxy(1, 1);
  gprintf("Down:");

  gotogxy(1, 16);
  gprintf("Up:");

  while (1) {
    // Plot the values
    position = 1;
    for (c = 1; c < GRAPHWIDTHHALF; c++) {

      // Generate downstream values
      if (c == 0 || array_downstream[c] == array_downstream[c - 1])
      {
        // Do nothing
        ;
      } else if (array_downstream[c] > array_downstream[c - 1])
      { // New value is higher than the old one --> generate line
        color(DKGREY, WHITE, SOLID);
        line(XOFFSET + position, YPOSITION - 1, XOFFSET + position, (YPOSITION - 1) - array_downstream[c]);
      } else {
        // Erase the rest of the line for downstream
        color(WHITE, WHITE, SOLID);
        line(XOFFSET + position, (YPOSITION - 1) - array_downstream[c], XOFFSET + position, YPOSITION - 51);
      }

      // Generate upstream values
      if (c == 0 || array_upstream[c] > array_upstream[c - 1])
      { // New value is higher than the old one --> generate line
        color(LTGREY, WHITE, SOLID);
        line(XOFFSET + position, YPOSITION + 1, XOFFSET + position, (YPOSITION + 1) + array_upstream[c]);
      } else { // Erase the rest of the line for upstream
        color(WHITE, WHITE, SOLID);
        line(XOFFSET + position, YPOSITION + 1 + array_upstream[c], XOFFSET + position, YPOSITION + 51);
      }

      // Generate point
      color(BLACK, WHITE, SOLID);
      plot_point(XOFFSET + position, YPOSITION - 1 - array_downstream[c]);
      plot_point(XOFFSET + position, YPOSITION + 1 + array_upstream[c]);
      position += 2;
    }

    // Set color to black for text
    color(BLACK, WHITE, SOLID);

    // Shift complete array to the left
    for (c = 0; c < GRAPHWIDTHHALF - 1; c++) {
      array_downstream[c] = array_downstream[c + 1];
      array_upstream[c] = array_upstream[c + 1];
    }

    // print current text-values downstream...
	if(packetreceived == 1){
		gotogxy(6, 1);
		if (current_downstream == 0)
		gprintf("<1 ", current_downstream);
		else
		gprintf("%u ", current_downstream);
		gprintf("/ %u Mbit  ", max_downstream);
		
		// ... and upstream
		gotogxy(6, 16);
		if (current_upstream == 0)
		gprintf("<1 ", current_upstream);
		else
		gprintf("%u ", current_upstream);
		gprintf("/ %u Mbit  ", max_upstream);
	} else {
		color(DKGREY, WHITE, SOLID);
		gotogxy(5, 4);
		gprintf("connecting");
		gotogxy(9, 5);
		gprintf("to");
		gotogxy(5, 6);
		gprintf("Fritz!Boy");
		gotogxy(9, 7);
		
		color(LTGREY, WHITE, SOLID);
		gotogxy(8, 11);
		gprintf("hold");
		gotogxy(6, 12);
		gprintf("\"SELECT\"");
		gotogxy(6, 13);
		gprintf("for demo");
	}

    // Receive new values from
    gotogxy(16, 16);
    s = buffer;

    if (DEBUG == 1) { // Debug the incoming values
      gotogxy(1, TMP);
      TMP++;
      TMP = TMP % 14;
      gprintf("IN:");
    }

    while (1) {
      receive_byte();
      /* Wait for IO completion... */
      while (_io_status == IO_RECEIVING) {
		if(joypad() == J_SELECT) {
			demomode = 1;
			break;
		}
	  }

	// Break the outer loop
    if(demomode == 1)
		break;
	     
      if (_io_status != IO_IDLE) { // Error
        if (DEBUG == 1){
			gotogxy(1, 5);
			gprintf("IO:%u", _io_status);
		}
        break;
      }

      if (DEBUG == 1)
        gprintf("%u", _io_in);

      *s = _io_in;
      if (*s == 255) {
        //if (_io_in == 255){
        // gprintf("X");
        break;
      }
      s++;
	}
	
	
	
    if (_io_status == IO_IDLE || demomode) {
		
		if(packetreceived == 0){ // First packet received
			// Clear the text
			color(WHITE, WHITE, SOLID);
			box(XOFFSET + 3, YPOSITION - 49, XOFFSET + GRAPHWIDTHFULL - 5, YPOSITION - 2, M_FILL);
			box(XOFFSET + 3, YPOSITION + 49, XOFFSET + GRAPHWIDTHFULL - 5, YPOSITION + 2, M_FILL);
			packetreceived = 1; // Hide the text
		}
				
		// current graph
		if(demomode){ // Demo = random
			random = rand();
			random = random % 50; // current downstream percent 0-49
			buffer[0] = random;
			random = rand();
			random = random % 50; // current downstream percent 0-49
			buffer[1] = random;
			buffer[2] = buffer[0];
			buffer[3] = buffer[1] / 10;
			buffer[4] = 100;
			buffer[5] = 10;
		
			demomode = 0;
		}
	
		array_downstream[GRAPHWIDTHHALF - 1] = buffer[0];
		array_upstream[GRAPHWIDTHHALF - 1] = buffer[1];
		current_downstream = buffer[2];
		current_upstream = buffer[3];
		max_downstream = buffer[4];
		max_upstream = buffer[5];
	
	  if(DEBUG == 1){
		gotogxy(1, 5);
		gprintf("cDp%u", buffer[0]);
		gotogxy(1, 6);
		gprintf("cUp%u", buffer[1]);
		
		gotogxy(1, 7);
		gprintf("cDa%u", buffer[2]);
		gotogxy(1, 8);
		gprintf("cUa%u", buffer[3]);
		
		gotogxy(1, 9);
		gprintf("U%u", max_upstream);
		gotogxy(1, 10);
		gprintf("D%u", max_downstream);
		}
    }
  }
  return 0;
}